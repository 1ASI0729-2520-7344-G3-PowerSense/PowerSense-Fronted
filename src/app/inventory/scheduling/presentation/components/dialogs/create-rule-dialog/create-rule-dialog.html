<div class="dialog-container">
  <h2 mat-dialog-title>
      <mat-icon>auto_awesome</mat-icon>
      Nueva Regla Inteligente
  </h2>

  <mat-dialog-content>
      <p class="dialog-description">
          <mat-icon>info</mat-icon>
          Las reglas inteligentes automatizan el control de tus dispositivos según condiciones predefinidas.
      </p>

      <div class="form-container">
          <mat-form-field appearance="outline">
              <mat-label>Tipo de Regla</mat-label>
              <mat-select [(ngModel)]="formData.type" (selectionChange)="onTypeChange()" required>
                  @for (type of ruleTypes; track type.value) {
                  <mat-option [value]="type.value">
                      {{ type.label }}
                  </mat-option>
                  }
              </mat-select>
              <mat-icon matPrefix>category</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline">
              <mat-label>Nombre de la Regla</mat-label>
              <input matInput [(ngModel)]="formData.name" placeholder="Ej: Apagar luces a las 11 PM" required
                  maxlength="50">
              <mat-icon matPrefix>label</mat-icon>
              <mat-hint align="end">{{ formData.name.length }}/50</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
              <mat-label>Descripción</mat-label>
              <textarea matInput [(ngModel)]="formData.description" rows="3" placeholder="Describe qué hace esta regla..."
                  required maxlength="150">
        </textarea>
              <mat-icon matPrefix>description</mat-icon>
              <mat-hint align="end">{{ formData.description.length }}/150</mat-hint>
          </mat-form-field>

          <div class="info-box">
              <mat-icon>lightbulb</mat-icon>
              <p><strong>Consejo:</strong> La regla se creará desactivada. Podrás activarla cuando estés listo.</p>
          </div>
      </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
      <button mat-button (click)="onCancel()">
          Cancelar
      </button>
      <button mat-raised-button color="primary" (click)="onCreate()" [disabled]="!isValid()">
          <mat-icon>add_circle</mat-icon>
          Crear Regla
      </button>
  </mat-dialog-actions>
</div>